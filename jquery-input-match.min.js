!function($){function init(a){current_object=objects[a],$("#"+inputMatchBoxId).length>0&&($("#"+inputMatchBoxId).remove(),$("#"+inputMatchBoxId+" li").removeClass("on")),current_object.on_match_box=!1,current_object.input_queue=[],current_object.input_queue_length=0,current_object.html="",current_object.current_match_item_position="",current_object.select_item_position=""}function getCurrentObject(a){current_object=objects[a]}function isArray(a){return Array.isArray?Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a)}function currentPath(a){for(var c,b=document.scripts,d=b.length;d>0;d--)b[d-1].src.indexOf(a)>-1&&(c=b[d-1].src.substring(0,b[d-1].src.lastIndexOf("/")+1));return c}function datasCheck(a){if(isArray(a)){for(i in a)if(void 0==a[i].text||void 0==a[i].value)return console.log("\u6570\u636e\u683c\u5f0f\u9519\u8bef"),!1;return a}return console.log("\u6570\u636e\u683c\u5f0f\u9519\u8bef"),!1}$.fn.inputMatch=function(a){count++,objects.push(this);var b=count,c={skin:"default",mustSelect:!1,maxLength:15,timeout:300,showOnFocus:!1,asParam:!1,match:!0,repeatRequest:!1,fillRightNow:!1};if(void 0!=a.data&&void 0!=a.url)return console.log("data\u6216url\u81f3\u5c11\u586b1\u4e2a"),!1;var d=[];if(void 0!=a.data&&(d=datasCheck(a.data),d===!1))return!1;if(void 0==a.timeout)var e=c.timeout;else var e=parseInt(a.timeout),e=isNaN(e)?c.timeout:e;if(void 0!=a.data&&(e=0),void 0==a.maxLength)var f=c.maxLength;else var f=parseInt(a.maxLength),f=isNaN(f)?c.maxLength:f;var g=void 0==a.showOnFocus||a.showOnFocus!==!1&&a.showOnFocus!==!0?c.showOnFocus:a.showOnFocus,h=void 0==a.mustSelect||a.mustSelect!==!1&&a.mustSelect!==!0?c.mustSelect:a.mustSelect,i=void 0==a.asParam||a.asParam!==!1&&a.asParam!==!0?c.asParam:a.asParam,j=i?a.paramName:"",k=void 0==a.match||a.match!==!1&&a.match!==!0?c.match:a.match,l=void 0==a.repeatRequest||a.repeatRequest!==!1&&a.repeatRequest!==!0?c.repeatRequest:a.repeatRequest,m=void 0!=a.selectCallback&&""!=a.selectCallback?a.selectCallback:"",n=[],o=!1,p=0,q=0,r=this;this.on_match_box=!1,this.html="",this.input_queue_length=0,this.input_queue=[],this.current_match_item_position="",this.select_item_position="",this.fillRightNow=void 0==a.fillRightNow||a.fillRightNow!==!1&&a.fillRightNow!==!0?c.fillRightNow:a.fillRightNow;for(var s=void 0==a.skin?"default":a.skin,t=currentPath("jquery-input-match.min.js")+"themes/"+s+".css",u=!0,v=0;v<$("head link").length;v++)if(void 0!=$("head link").eq(v).attr("input-match-skin")&&$("head link").eq(v).attr("input-match-skin")==s){u=!1;break}u&&$("head").append("<link rel='stylesheet' input-match-skin='"+s+"' type='text/css' href='"+t+"'>"),inputMatchBoxId=s+"-input-match-box";var w=function(){var a=r.val();for(v in d)if(a==d[v].text)return!0;return!1},x={},y=function(){var b=void 0==r.input_queue[r.input_queue.length-1]?"":r.input_queue[r.input_queue.length-1];return i&&""!=j?(x[j]=b,escape(a.url+j+b)):escape(a.url)},z=function(){r.input_queue_length=r.input_queue.length;var b=y();void 0==a.data?void 0!=a.url&&(l||!l&&void 0==n[b]?(q=1,$.getJSON(a.url,x,function(a){if(q=0,0!=r.input_queue.length&&o){var c=datasCheck(a);c!==!1&&(d=c,n[b]=d,C())}})):(d=n[b],C())):C()},A=function(){init(b);var a=f<d.length?f:d.length,c=1,e=r.val();for(v in d){if(!(a>=c))break;var g=d[v];k&&""!=e?-1!==g.text.indexOf(e)&&(B(g,c),c++):(B(g,c),c++)}if(""!=r.html){var h=r.offset(),i=h.left,j=h.top+r.outerHeight()+5;r.html="<ul id='"+inputMatchBoxId+"' class='input-match-box' onmouseleave='moveOnInputMatchBox("+b+",0)' onmouseenter='moveOnInputMatchBox("+b+",1)' style='position:absolute;top:"+j+"px;left:"+i+"px'>"+r.html+"</ul>",$("body").append(r.html)}},B=function(a,c){var d=r.val();if(d==a.text&&""===r.current_match_item_position){var e='class="on"';r.current_match_item_position=r.select_item_position=c-1}else var e="";var f=1==c?'style="border:none"':"";r.html=r.html+"<li "+e+' onclick="inputMatchItemSelect('+b+",'"+a.value+"','"+a.text+"','"+m+'\')" onmouseover="moveOverInputMatchItem('+b+',$(this))" value-v="'+a.value+'" '+f+">"+a.text+"</li>",c++},C=function(){if(e>0){var b=y();if(void 0!=a.data||void 0==a.url||l||void 0==n[b]){var c=(new Date).getTime();c-p>=e?D():setTimeout(function(){C()},50)}else d=n[b],A()}else D()},D=function(){r.input_queue.length>r.input_queue_length?1==q?setTimeout(function(){C()},50):z():A()};this.keydown(function(a){return 13==a.keyCode?(a.preventDefault(),a.stopPropagation(),!1):void 0}),this.keyup(function(c){if(13==c.keyCode)""!==r.select_item_position&&inputMatchItemSelect(b,$("#"+inputMatchBoxId+" li").eq(r.select_item_position).attr("value-v"),$("#"+inputMatchBoxId+" li").eq(r.select_item_position).text(),m);else if(38==c.keyCode||40==c.keyCode)moveSelectInputMatchItem(b,c.keyCode);else if($("#"+inputMatchBoxId).length>0&&$("#"+inputMatchBoxId).hide(),p=(new Date).getTime(),void 0!=a.data)r.input_queue.push(r.val()),1==r.input_queue.length&&C();else if(void 0!=a.url&&""!=a.url)if(r.input_queue.push(r.val()),1==r.input_queue.length)C();else{var e=y();void 0!=a.data||void 0==a.url||l||void 0==n[e]||(d=n[e],A())}return c.preventDefault(),c.stopPropagation(),!1}),this.focus(function(b){o=!0,g&&(void 0!=a.data?(r.input_queue.push(r.val()),C()):void 0!=a.url&&""!=a.url&&(r.input_queue.push(r.val()),C()))}),this.blur(function(a){o=!1,r.on_match_box||(h&&(d.length>0&&w()||r.val("")),init(b))})};var count=-1,objects=[],inputMatchBoxId="",current_object="";window.moveSelectInputMatchItem=function(a,b){if(getCurrentObject(a),$("#"+inputMatchBoxId).length>0&&(38==b||40==b)){var d=$("#"+inputMatchBoxId+" li").length-1,e=""===current_object.select_item_position?0:38==b?current_object.select_item_position-1:current_object.select_item_position+1;e=0>e?0:e>d?d:e,moveOverInputMatchItem(a,$("#"+inputMatchBoxId+" li").eq(e))}},window.moveOnInputMatchBox=function(a,b){getCurrentObject(a),1==b?current_object.on_match_box=!0:(current_object.on_match_box=!1,current_object.fillRightNow||(current_object.select_item_position=current_object.current_match_item_position,$("#"+inputMatchBoxId+" li").removeClass("on"),""!==current_object.current_match_item_position&&$("#"+inputMatchBoxId+" li").eq(current_object.current_match_item_position).addClass("on")))},window.moveOverInputMatchItem=function(a,b){getCurrentObject(a),$("#"+inputMatchBoxId+" li").removeClass("on"),b.addClass("on"),current_object.select_item_position=$("#"+inputMatchBoxId+" li").index(b),current_object.fillRightNow&&(current_object.current_match_item_position=current_object.select_item_position,current_object.val(b.text()))},window.inputMatchItemSelect=function(obj_count,value,text,callback){getCurrentObject(obj_count),current_object.val(text),init(obj_count),current_object.blur(),""!=callback&&eval(callback+"('"+value+"','"+text+"')")}}(jQuery);